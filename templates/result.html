{% extends "base.html" %}

{% block content %}
<div class="flex min-h-screen">
    <!-- Sidebar -->
    <aside class="w-64 gradient-bg text-white p-6 shadow-2xl">
        <div class="mb-8">
            <h1 class="text-2xl font-bold mb-2">üöÄ AI Outreach</h1>
            <p class="text-sm text-indigo-200">Personalized Engagement</p>
        </div>

        <nav class="space-y-4">
            <a href="/"
                class="flex items-center space-x-3 p-3 rounded-lg bg-white bg-opacity-20 hover:bg-opacity-30 transition">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                </svg>
                <span class="font-medium">Back to Dashboard</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-8 bg-gray-50">
        <div class="max-w-4xl mx-auto animate-fade-in">
            {% if error %}
            <!-- Error State -->
            <div class="bg-red-50 border-2 border-red-300 rounded-2xl p-8 mb-6">
                <div class="flex items-center space-x-3 mb-4">
                    <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <h2 class="text-2xl font-bold text-red-800">Error Occurred</h2>
                </div>
                <p class="text-red-700 mb-4">{{ error }}</p>
                <p class="text-sm text-red-600 mb-4">URL attempted: <code
                        class="bg-red-100 px-2 py-1 rounded">{{ url }}</code></p>
                <a href="/"
                    class="inline-block gradient-bg text-white font-semibold py-3 px-6 rounded-xl hover:shadow-lg transition">
                    Try Again
                </a>
            </div>

            {% else %}
            <!-- Success State -->
            <div class="mb-6">
                <div class="bg-green-50 border-2 border-green-300 rounded-xl p-4 mb-6">
                    <div class="flex items-center space-x-2">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7">
                            </path>
                        </svg>
                        <p class="text-green-800 font-semibold">Content Generated Successfully!</p>
                    </div>
                </div>

                <!-- Company Info Card -->
                <div class="bg-white rounded-3xl shadow-xl p-8 mb-8 border border-gray-100">
                    <h3 class="text-lg font-bold text-gray-800 mb-6 flex items-center">
                        <svg class="w-5 h-5 mr-3 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4">
                            </path>
                        </svg>
                        Target Company Profile
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-gray-50 p-4 rounded-2xl">
                            <span class="text-[10px] font-bold text-indigo-500 uppercase tracking-widest">Company
                                Name</span>
                            <p class="text-gray-900 font-bold text-lg mt-1">{{ company_name }}</p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-2xl">
                            <span class="text-[10px] font-bold text-indigo-500 uppercase tracking-widest">Website</span>
                            <p class="text-blue-600 truncate mt-1 font-medium">
                                <a href="{{ url }}" target="_blank" class="hover:underline">{{ url }}</a>
                            </p>
                        </div>
                        <div class="md:col-span-2 bg-gray-50 p-4 rounded-2xl">
                            <span class="text-[10px] font-bold text-indigo-500 uppercase tracking-widest">Contextual
                                Description</span>
                            <p class="text-gray-600 text-sm mt-2 leading-relaxed">{{ description }}</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 1. Cold Email Card -->
            <div class="bg-white rounded-2xl shadow-xl p-8 mb-8 border border-gray-100">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-gray-800 flex items-center">
                        <svg class="w-6 h-6 mr-2 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z">
                            </path>
                        </svg>
                        Cold Email <span
                            class="ml-2 text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded-full">Editable</span>
                    </h2>
                    <button onclick="copyToClipboard('emailInput', 'copyEmailBtn', 'copyEmailText')" id="copyEmailBtn"
                        class="gradient-bg text-white font-semibold py-2 px-4 rounded-lg hover:shadow-lg transition flex items-center space-x-2 text-sm">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
                            </path>
                        </svg>
                        <span id="copyEmailText">Copy Email</span>
                    </button>
                </div>

                <textarea id="emailInput"
                    class="w-full h-64 p-4 rounded-xl border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition font-mono text-sm leading-relaxed resize-y bg-gray-50 hover:bg-white focus:bg-white"
                    spellcheck="false">{{ email_body }}</textarea>
            </div>

            <!-- 2. LinkedIn Note Card -->
            <div class="bg-white rounded-2xl shadow-xl p-8 mb-8 border border-gray-100">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-gray-800 flex items-center">
                        <svg class="w-6 h-6 mr-2 text-blue-700" fill="currentColor" viewBox="0 0 24 24">
                            <path
                                d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z" />
                        </svg>
                        LinkedIn Note <span class="ml-2 text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full">Max
                            300 chars</span>
                    </h2>
                    <button onclick="copyToClipboard('linkedinInput', 'copyLiBtn', 'copyLiText')" id="copyLiBtn"
                        class="bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-blue-700 hover:shadow-lg transition flex items-center space-x-2 text-sm">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
                            </path>
                        </svg>
                        <span id="copyLiText">Copy Note</span>
                    </button>
                </div>

                <textarea id="linkedinInput"
                    class="w-full h-32 p-4 rounded-xl border border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition font-sans text-sm leading-relaxed resize-y bg-gray-50 hover:bg-white focus:bg-white"
                    spellcheck="false">{{ linkedin_note }}</textarea>
                <p class="text-right text-xs text-gray-400 mt-2">Edit before copying</p>
            </div>

            <!-- Action Buttons -->
            <div class="mt-6 flex space-x-4">
                <a href="/"
                    class="flex-1 text-center gradient-bg text-white font-semibold py-4 px-6 rounded-xl hover:shadow-xl transition transform hover:-translate-y-1">
                    ‚ú® Generate Another
                </a>
                <button onclick="window.print()"
                    class="hidden md:block bg-gray-800 text-white font-semibold py-4 px-6 rounded-xl hover:bg-gray-900 transition transform hover:-translate-y-1">
                    üñ®Ô∏è Print / Save PDF
                </button>
            </div>
            {% endif %}
        </div>
    </main>
</div>

<script>
    function copyToClipboard(elementId, btnId, textId) {
        const content = document.getElementById(elementId).value;
        const copyBtn = document.getElementById(btnId);
        const copyText = document.getElementById(textId);
        const originalText = copyText.textContent;
        const originalClasses = copyBtn.className;

        navigator.clipboard.writeText(content).then(() => {
            copyText.textContent = 'Copied!';

            // Temporary success style
            copyBtn.classList.remove('gradient-bg', 'bg-blue-600', 'hover:bg-blue-700');
            copyBtn.classList.add('bg-green-600', 'hover:bg-green-700');

            setTimeout(() => {
                copyText.textContent = originalText;
                copyBtn.className = originalClasses; // Restore original classes
            }, 2000);
        }).catch(err => {
            alert('Failed to copy: ' + err);
        });
    }
</script>
{% endblock %}